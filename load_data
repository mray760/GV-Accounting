import pandas as pd



# Load both sheets from Excel
def load_data(excel_file):
    charges_df = pd.read_excel(excel_file, sheet_name='charges_and_payments')
    charges_df = charges_df[charges_df['unit_status'] == 'Occupied']
    charges_df['outstanding_amount'] = charges_df['monthly_rate'].fillna(0) + charges_df['late_fees'].fillna(0) - charges_df['credit'].fillna(0) - charges_df['cash_payment'].fillna(0)
    charges_df['net_charge'] = charges_df['monthly_rate'].fillna(0) - charges_df['credit'].fillna(0)
    charges_df['tenant_name'] = charges_df['tenant_name'].fillna('empty')
    print(charges_df.head())
    transactions_df = pd.read_excel(excel_file, sheet_name='transactions', parse_dates=['date'])
    transactions_df['date'] = pd.to_datetime(transactions_df['date'], errors='coerce')
    #charges_df['date'] = pd.to_datetime(charges_df['date'], errors='coerce')
    return charges_df, transactions_df
