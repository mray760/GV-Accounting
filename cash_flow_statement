import pandas as pd



def create_cf_statement(income_statement, trial_balance):

    ### Operating Cash Flow Statement
    net_income_df = income_statement[income_statement["account"] == "Net Income"].reset_index(drop=True)
    net_income_df.drop(columns='Type', inplace=True)

    print(net_income_df)

    print()

    op_reduction_accounts = ['Accounts Receivable']
    op_increase_accounts = ['Credit Card','Unearned Rent']

    non_cash_revenues = trial_balance[trial_balance['account'].isin(op_reduction_accounts)].copy()
    non_cash_revenues = non_cash_revenues[['account','Net D/C']]
    non_cash_revenues['Amount'] = non_cash_revenues['Net D/C'].abs()
    non_cash_revenues.drop(columns='Net D/C',inplace=True)


    non_cash_expenses = trial_balance[trial_balance['account'].isin(op_increase_accounts)].copy()
    non_cash_expenses = non_cash_expenses[['account','Net D/C']]
    non_cash_expenses['Amount'] = non_cash_expenses['Net D/C'].abs()
    non_cash_expenses.drop(columns='Net D/C', inplace=True)

    print(non_cash_revenues)

    print()

    print(non_cash_expenses)

    merged_df = pd.concat([net_income_df,non_cash_expenses,non_cash_revenues])

    total_value = (
            merged_df.loc[merged_df["account"] == "Net Income", "Amount"].sum()
            + merged_df.loc[merged_df["account"] == "Unearned Rent", "Amount"].sum()
            + merged_df.loc[merged_df["account"] == "Credit Card", "Amount"].sum()
            - merged_df.loc[merged_df["account"] == "Accounts Receivable", "Amount"].sum()
    )

    merged_df.loc[len(merged_df)] = ["Total", total_value]
    print(merged_df)



    return net_income_df
